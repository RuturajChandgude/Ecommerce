<div>
    <div class="product">
    <!-- <mat-dialog-content>
    @for(p of data;track p.productId)
    {
         <mat-checkbox [checked]="selectedProduct[p.productId]!==undefined" (change)="onCheckBoxChange(p.productId,$event)" ><h3>{{p.productName}}</h3></mat-checkbox>
        <p>Product Cost: Rs {{p.productCost}}</p>
        @for(img of p.productImgUrl;track img)
        {
          <img [src]="img">
        }
        <br>
        @if(selectedProduct[p.productId] && p.productQuantity===0)
        {
          <p style="color: red;">Product is out of stock</p>
        }
        @if(selectedProduct[p.productId] && p.productQuantity>0)
        {
        <div class="addDecrease">
         <button mat-icon-button aria-label="Add" (click)="decrease(p.productId)"><mat-icon>remove</mat-icon></button>
        <span>{{ selectedProduct[p.productId] }}</span>
        <button mat-icon-button aria-label="Subtract" (click)="increase(p.productId)"><mat-icon>add</mat-icon></button>
      </div><br>
        }
    }
  </mat-dialog-content> -->
   <mat-dialog-content>
  <table  mat-table [dataSource]="dataSource" class="mat-elevation-z8" >
    <ng-container  matColumnDef="select">
        <th mat-header-cell *matHeaderCellDef>Select</th>
        <td mat-cell *matCellDef="let p">
          <mat-checkbox [checked]="selectedProduct[p.productId]!==undefined" (change)="onCheckBoxChange(p.productId,$event)" >
            <h3>{{p.productName}}</h3>
          </mat-checkbox>
        </td>
    </ng-container>

    <ng-container matColumnDef="productCategory">
        <th mat-header-cell *matHeaderCellDef >
            Category </th>
        <td mat-cell *matCellDef="let p"> {{p.productCategory.productCategory}} </td>
    </ng-container>

    <ng-container matColumnDef="productCost">
        <th mat-header-cell *matHeaderCellDef> Cost
        </th>
        <td mat-cell *matCellDef="let p">
        {{convertCurrency(p.productCost)}}  
        </td>
    </ng-container>

     <ng-container matColumnDef="productQuantity">
        <th mat-header-cell *matHeaderCellDef > Available Quantity
        </th>
        <td mat-cell *matCellDef="let p">
            @if(p.productQuantity < 1)
            {
                <span style="color: red;">Out of stock</span>
            }
            @else{ {{p.productQuantity}} }</td>
    </ng-container>

    <ng-container matColumnDef="quantity">
        <th mat-header-cell *matHeaderCellDef > Select Quantity
        </th>
        <td mat-cell *matCellDef="let p">
          <div class="addDecrease">
         <button mat-icon-button aria-label="Add" (click)="decrease(p.productId)"><mat-icon>remove</mat-icon></button>
         @if(!selectedProduct[p.productId])
         {
          <span>1</span>
         }
         @else{

           <span>{{ selectedProduct[p.productId] }}</span>
         }
        <button mat-icon-button aria-label="Subtract" (click)="increase(p.productId)"><mat-icon>add</mat-icon></button>
      </div>
          <!-- @if(selectedProduct[p.productId] && p.productQuantity>0)
        {
        <div class="addDecrease">
         <button mat-icon-button aria-label="Add" (click)="decrease(p.productId)"><mat-icon>remove</mat-icon></button>
        <span>{{ selectedProduct[p.productId] }}</span>
        <button mat-icon-button aria-label="Subtract" (click)="increase(p.productId)"><mat-icon>add</mat-icon></button>
      </div>
       } -->
        </td>
    </ng-container>
    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
</table>
  </mat-dialog-content>
</div>

</div>
<mat-dialog-actions style="margin-top: 20px;" align="end">
  <button style="margin-right: 10px;"  mat-raised-button color="primary" (click)="addSelectedToCart()" [disabled]="selectedCount===0">Add to cart</button>
    <button  mat-button color="warn" (click)="dialogRef.close()">Cancel</button>
</mat-dialog-actions>